---
title: –û—Å–Ω–æ–≤—ã –∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
---
## –í–æ–ø—Ä–æ—Å—ã
### –ß—Ç–æ —Ç–∞–∫–æ–µ docker –∏ –∫–∞–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã linux –ª–µ–∂–∞—Ç –≤ –æ—Å–Ω–æ–≤–µ? –î–ª—è —á–µ–≥–æ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

Docker –±–∞–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö **namespaces**, **cgroups**, **capabilities**, **overlay**
**namespaces** - –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∏–∑–æ–ª—è—Ü–∏—é. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –∞–π–¥–∏—à–Ω–∏–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.
**cgroup** - —à—Ç—É–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –≥—Ä—É–ø–ø–æ–π –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏—Ö —Ä–µ—Å—É—Ä—Å–∞–º–∏.
**capabilites** - —à—Ç—É–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä—É—Ç –ø—Ä–∏–≤–µ–ª–µ–≥–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º –∏–ª–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º —Ñ–∞–π–ª–∞–º. –ù–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–º–µ–Ω–∏—Ç—å UID –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞ 0, –∏–ª–∏ –¥–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã.
**overlay (overlayFS, overlay2-–¥—Ä–∞–π–≤–µ—Ä)** - —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è —É–º–µ–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å "—Å–ª–æ—è–º–∏". –ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã, –∞ –Ω–∞—Å–ª–∞–∏–≤–∞—Ç—å –æ–¥–∏–Ω —Å–ª–æ–π –Ω–∞ –¥—Ä—É–≥–æ–π, —Ç–µ–º —Å–∞–º—ã–º —ç–∫–æ–Ω–æ–º—è –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

–ê –≤–æ—Ç –¥–æ–∫–µ—Ä - —ç—Ç–æ —É–∂–µ —à—Ç—É–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—Å–µ–º–∏ —ç—Ç–∏–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏ —Ä—É–ª–∏—Ç. –î–∞ –µ—â—ë –∏ —É–¥–æ–±–Ω—ã–º –¥–ª—è –Ω–∞—Å –æ–±—Ä–∞–∑–æ–º.

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–æ–∫–µ—Ä–∞:
1. Docker Daemon ‚Äî —Ç–æ —Å–∞–º–æ–µ Container Engine; –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.
2. Docker CII ‚Äî —É—Ç–∏–ª–∏—Ç–∞ –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é Docker.
3. Dockerfile ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–æ–º—É, –∫–∞–∫ —Å–æ–±–∏—Ä–∞—Ç—å –æ–±—Ä–∞–∑.
4. Image ‚Äî –æ–±—Ä–∞–∑, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ä–∞—Å–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.
5. Container.
6. Docker registry ‚Äî —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –æ–±—Ä–∞–∑–æ–≤.

![Docker](../img/docker/docker.png)

–ù–∞ Docker_host —Ä–∞–±–æ—Ç–∞–µ—Ç Docker daemon, –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã. –ï—Å—Ç—å Client, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞—ë—Ç –∫–æ–º–∞–Ω–¥—ã: —Å–æ–±–µ—Ä–∏ –æ–±—Ä–∞–∑, —Å–∫–∞—á–∞–π –æ–±—Ä–∞–∑, –∑–∞–ø—É—Å—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä. Docker daemon —Ö–æ–¥–∏—Ç –≤ registry –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏—Ö. Docker-–∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∏ –ª–æ–∫–∞–ª—å–Ω–æ (–∫ —é–Ω–∏–∫—Å-—Å–æ–∫–µ—Ç—É), –∏ –ø–æ TCP —Å —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞.

Docker daemon (–¥–µ–º–æ–Ω) ‚Äî —ç—Ç–æ —Å–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å, –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–µ: —Å–∫–∞—á–∏–≤–∞–µ—Ç –æ–±—Ä–∞–∑—ã –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–∑ –Ω–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —Å–æ–∑–¥–∞—ë—Ç —Å–µ—Ç—å –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏, —Å–æ–±–∏—Ä–∞–µ—Ç –ª–æ–≥–∏. –ö–æ–≥–¥–∞ –º—ã –≥–æ–≤–æ—Ä–∏–º ¬´—Å–æ–∑–¥–∞–π –æ–±—Ä–∞–∑¬ª, —ç—Ç–∏–º —Ç–æ–∂–µ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –¥–µ–º–æ–Ω.

Docker CLI ‚Äî –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å Docker, –∫–æ–Ω—Å–æ–ª—å–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–µ–º–æ–Ω–æ–º. –ü–æ–≤—Ç–æ—Ä—é, –æ–Ω–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–æ –∏ –ø–æ —Å–µ—Ç–∏.

### –ß—Ç–æ —Ç–∞–∫–æ–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –æ–±—Ä–∞–∑—ã? –í —á—ë–º –∑–∞–∫–ª—é—á–∞—é—Ç—Å—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è?

**–û–±—Ä–∞–∑** - —à–∞–±–ª–æ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –≤ —Ä–µ–∂–∏–º–µ "—Ç–æ–ª—å–∫–æ-—á—Ç–µ–Ω–∏–µ".
**–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä** - –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –æ–±—Ä–∞–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –∫—Ä–æ–º–µ –Ω–∏–∂–Ω–∏—Ö —Å–ª–æ–µ–≤ –≤ —Ä–µ–∂–∏–º–µ "—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ" —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–µ—Ä—Ö–Ω–∏–π —Å–ª–æ–π –≤ —Ä–µ–∂–∏–º–µ "—á—Ç–µ–Ω–∏–µ-–∑–∞–ø–∏—Å—å".
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä - —ç—Ç–æ —É–∂–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–µ –∏ –∑–∞–ø—É—â–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –û–¥–Ω–∞–∂–¥—ã –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ, –µ–≥–æ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å, –º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å, –Ω–æ –¥–æ —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —ç—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä–∞—è –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å —Å–æ —Å–≤–æ–∏–º id. –ü—Ä–æ–¥–æ–ª–∂–∞—è –∞–Ω–∞–ª–æ–≥–∏—é —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ü–û, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –∏ —Ä–∞–±–æ—Ç–∞—é—â–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π –Ω–∞ –ü–ö.
–û–±—Ä–∞–∑ - –≠—Ç–æ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π –æ–±—Ä–∞–∑, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä. –ï–≥–æ –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∫ –Ω–∞–±–æ—Ä —Ñ–∞–π–ª–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –¥—Ä—É–≥–æ–º —Ö–æ—Å—Ç–µ. –ú–æ–∂–Ω–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–æ–≥–∏—é –∏–∑ –º–∏—Ä–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ü–û: –æ–±—Ä–∞–∑ ‚Äî —ç—Ç–æ –∫–æ–º–ø–∞–∫—Ç-–¥–∏—Å–∫, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∞.

### –í –∫–∞–∫–æ–º –≤–∏–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –æ–±—Ä–∞–∑—ã? –î–ª—è —á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–æ–∏? –ß—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π overlayfs?

**–û–±—Ä–∞–∑—ã(images)** - —ç—Ç–æ –ª–æ–≥–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–ª–æ–µ–≤ –ø–ª—é—Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–º, —á—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ –∫–∞–∫ —Å–æ–±–∏—Ä–∞—Ç—å —Å–ª–æ–∏. –ß–∞—Å—Ç—å —ç—Ç–∏—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –∫–∞–∂–¥—ã–π —Å–ª–æ–π –∑–Ω–∞–µ—Ç ID —Å–≤–æ–µ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è.
–ò—Ç–∞–∫, —á—Ç–æ –≤—Ö–æ–¥–∏—Ç –≤ —Å–ª–æ–π? –§–∞–π–ª—ã (–∏ –∫–∞—Ç–∞–ª–æ–≥–∏), –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –¥–æ–±–∞–≤–∏–ª–∏ –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —Ñ–∞–π–ª. –°—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–∞–∫–∂–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã ("whiteout"), –∫–æ—Ç–æ—Ä—ã–µ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —Ç–æ, —á—Ç–æ —á—Ç–æ-—Ç–æ –±—ã–ª–æ —É–¥–∞–ª–µ–Ω–æ –∏–∑ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ñ–∞–π–ª–∞.
Docker-image ‚Äî —à–∞–±–ª–æ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è (read-only) —Å –Ω–∞–±–æ—Ä–æ–º –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –û–Ω —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–æ–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ Docker –∫–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç –≤ –æ–¥–∏–Ω –æ–±—Ä–∞–∑ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã UnionFS. –¢–∞–∫ —Ä–µ—à–∞–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–æ–≤–æ–π –ø–∞–º—è—Ç–∏. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—Ä–∞–∑–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤ Docker-file.

### –ß—Ç–æ —Ç–∞–∫–æ–µ docker commit

–≠—Ç–æ —É—Ç–∏–ª–∏—Ç–∞, —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ —Å–æ—â–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –æ–±—Ä–∞–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ª–∏–±–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å —Ç–µ–∫—É—â–∏–π –æ–±—Ä–∞–∑

–ú–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ –∫–æ–≥–¥–∞ —Ç—ã —á—Ç–æ —Ç—ã –∏–∑–º–µ–Ω–∏–ª –∫–∞–∫–æ–π —Ç–æ —Ñ–∞–π–ª –≤ docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –∏ —Ç–µ–±–µ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç—Ç–æ—Ç –Ω–æ–≤—ã–π —Ä–∞–±–æ—á–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –æ–±—Ä–∞–∑.

### –ß—Ç–æ —Ç–∞–∫–æ–µ —Å–ª–æ–∏ –≤ –¥–æ–∫–µ—Ä–µ?

–ü–æ —Å—É—Ç–∏, —Å–ª–æ–π –∏–ª–∏ _—Å–ª–æ–π –æ–±—Ä–∞–∑–∞_ —ç—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–±—Ä–∞–∑–∞ –∏–ª–∏ **–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞**. –ö–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞, —É–∫–∞–∑–∞–Ω–Ω–∞—è (`FROM`, `RUN`, `COPY` –∏ —Ç.–¥.) –≤ –≤–∞—à–µ–º Dockerfile –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π –æ–±—Ä–∞–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Å–æ–∑–¥–∞–≤–∞—è —Ç–µ–º —Å–∞–º—ã–º –Ω–æ–≤—ã–π —Å–ª–æ–π. –í—ã –º–æ–∂–µ—Ç–µ –¥—É–º–∞—Ç—å –æ–± —ç—Ç–æ–º –∫–∞–∫ –æ –≤–Ω–µ—Å–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ git: –≤—ã –¥–æ–±–∞–≤–ª—è–µ—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞, –∑–∞—Ç–µ–º –µ—â–µ –æ–¥–Ω–æ, –∑–∞—Ç–µ–º –¥–æ–±–∞–≤–ª—è—è –µ—â—ë –æ–¥–Ω–æ, –∏ —Å–ª–æ–∏ –Ω–∞–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –æ–¥–∏–Ω –∑–∞ –¥—Ä—É–≥–∏–º.

–¢–∞–∫ –∂–µ –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –Ω–æ–≤—ã–π —Å–ª–æ–π.

### –ß—Ç–æ —Ç–∞–∫–æ–µ —ç—Ñ–µ–º–µ—Ä–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã?

[–≠—Ñ–µ–º–µ—Ä–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã](https://kubernetes.io/docs/concepts/workloads/pods/ephemeral-containers/) —Å—Ç–∞–ª–∏ –±–µ—Ç–∞-—Ñ—É–Ω–∫—Ü–∏–µ–π –≤ Kubernetes v1.23 –∏ —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
–≠—Ñ–µ–º–µ—Ä–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è —Ç—Ä–∞–Ω–∑–∏—Ç–Ω—ã—Ö –∑–∞–¥–∞—á, –∫–æ–≥–¥–∞ –≤–∞–º –Ω—É–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ [–ø–æ–¥–∫–ª—é—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ø–æ–¥—É](https://kubernetes.io/docs/tasks/debug/debug-application/debug-running-pod/#ephemeral-container). –≠—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –∫–æ–≥–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥—ã, –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—è –∂–∏–≤—ã–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

### –ü–æ—á–µ–º—É latest –æ–±—Ä–∞–∑—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ?

–°–ª–æ–∂–Ω–æ –≤ –æ—Ç–ª–∞–¥–∫–µ –∫–∞–∫ –º–∏–Ω–∏–º—É–º. –ù–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –∫–∞–∫–∞—è –∏–º–µ–Ω–Ω–æ –≤–µ—Ä—Å–∏—è –∑–∞–∫–æ—Å—è—á–∏–ª–∞. –ê —Ç–∞–∫ –ø—Ä–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏, –ø—É—Å—Ç—å –¥–∞–ª—å—à–µ –Ω–∞ –Ω–µ–π –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç.
–ü–æ–º–∏–º–æ —ç—Ç–æ–≥–æ —ç—Ç–æ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ. –ù–∏–∫—Ç–æ –Ω–µ –∑–Ω–∞–µ—Ç —á—Ç–æ –≤—ã–∫–∞—Ç–∏—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –≤ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏. –ú–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ.

### –ß—Ç–æ —Ç–∞–∫–æ–µ kata –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä?

–≠—Ç–æ –∏–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –ö–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –æ—Å–∏ –ø–æ–¥ –æ—Ç–∫—Ä—ã—Ç–æ–π –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–æ–π. **Kata Containers** –æ–±—ä–µ–¥–∏–Ω—è—é—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω (VM). –û–Ω–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å **–∏–∑–æ–ª—è—Ü–∏–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º **–ª—ë–≥–∫–æ—Å—Ç—å –∏ —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**.  
–ï—Å–ª–∏ –æ–±—ã—á–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ Linux, —É **Kata Containers** –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è qemu, kvm.
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ —Å—Ç–µ—Ä–æ–∏–¥–∞—Ö. –ë–æ–ª—å—à–µ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–¥—É–º–∞–Ω–æ.

### –ú–æ–∂–Ω–æ –ª–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –∏–∑ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã Linux –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥ `docker`?

**–û—Ç–≤–µ—Ç:**

–î–∞, –º–æ–∂–Ω–æ. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ Linux ‚Äî —ç—Ç–æ –æ–±—ã—á–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—Å—Ç—å —Å–≤–æ—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞, –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤ –∫–∞—Ç–∞–ª–æ–≥ `/var/lib/docker/...`.  
#### üîπ –°–ø–æ—Å–æ–±—ã

1. **–ß–µ—Ä–µ–∑ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**
   - –§–∞–π–ª—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ª–µ–∂–∞—Ç –≤ `/var/lib/docker/overlay2/<ID>/merged/`.  
   - –ú–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (`docker inspect <container> | grep MergedDir`) –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –Ω–∞–ø—Ä—è–º—É—é:
```bash
cp /host/file /var/lib/docker/overlay2/<ID>/merged/path/in/container/
```

2. **–ß–µ—Ä–µ–∑ `nsenter` –≤ namespace –ø—Ä–æ—Ü–µ—Å—Å–∞**
   - –£ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –µ—Å—Ç—å —Å–≤–æ–π PID namespace. –ú–æ–∂–Ω–æ –≤–æ–π—Ç–∏ —Ç—É–¥–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Linux:  
```bash
PID=$(docker inspect -f '{{.State.Pid}}' <container>)
nsenter --target $PID --mount --uts --ipc --net --pid
cp /host/file /path/in/container/
```

3. **–ß–µ—Ä–µ–∑ –æ–±—â–∏–π volume**
   - –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç volume –∏–ª–∏ bind-mount, —Ñ–∞–π–ª –º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä—è–º–æ –≤ —ç—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ –Ω–∞ —Ö–æ—Å—Ç–µ, –∏ –æ–Ω –ø–æ—è–≤–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.  

üìå –ò—Ç–æ–≥:  
–î–∞, –º–æ–∂–Ω–æ. –ë–µ–∑ `docker cp` –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –≤–æ–∑–º–æ–∂–µ–Ω —á–µ—Ä–µ–∑:  
- –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/var/lib/docker/overlay2/.../merged`,  
- `nsenter` –≤ namespace –ø—Ä–æ—Ü–µ—Å—Å–∞,  
- –∏–ª–∏ volume/bind-mount.  

